#!/opt/anaconda3/envs/gg337/bin/python
import pandas as pd 
import re 
import spacy
import warnings
warnings.filterwarnings("ignore", category=FutureWarning)
from collections import defaultdict, Counter
from collections import defaultdict, Counter
from nltk import ngrams
from rapidfuzz import fuzz


def get_final_awards(tweets):
    # from Awards import tweets 
    # tweets = ['picture   drama', 'picture   drama', 'tv actress comedy', 'tv actress comedy', 'original song   such an amazing song', 'original song   such an amazing song', 'song in movie', 'song in movie', 'song in movie', 'foreign film  ', 'foreign film  ', 'actor in a motion picture   comedy or musical', 'actor in a motion picture   comedy or musical', 'mini series tv movie', 'mini series tv movie', 'actor tv series drama', 'actor tv series drama', 'actress in a miniseries or motion picture made for television', 'actress in a miniseries or motion picture made for television', 'original song in', 'original song in', 'actress motion picture comedy or musical', 'actress motion picture comedy or musical', 'picture   drama', 'actor tv movie or mini', 'actor tv movie or mini', 'actress in a mini series or tv movie', 'actress in a mini series or tv movie', 'actress in a television seriesdrama', 'actress in a television seriesdrama', 'actress in a motion picture musical or comedy', 'actress in a motion picture musical or comedy', 'motion picture   drama boy', 'motion picture   drama boy', 'actress in a   comedy', 'actress in a   comedy', 'actor in a motion picture   drama', 'actor in a motion picture   drama', 'actor in a film', 'actor in a film', 'actor in a motion picture   comedy or musical', 'comedymusical movie  ', 'comedymusical movie  ', 'picture   drama', 'picture   drama', 'actress in a comedy or musical', 'actress in a comedy or musical', 'tv series drama', 'tv series drama', 'actor in a tv series', 'actor in a tv series', 'actress in a tv series   comedy or musical', 'actress in a tv series   comedy or musical', 'actress in a tv series', 'actress in a tv series', 'actor in a comedy or musical', 'actor in a comedy or musical', 'actor in a motion picture comedy or musical', 'actor in a motion picture comedy or musical', 'actor   drama   award', 'actor   drama   award', 'actor   drama   award', 'actress in a   comedy', 'actress in a   comedy', 'actor in a motion picture   drama', 'actor in a motion picture   drama', 'motion picture drama  ', 'motion picture drama  ', 'actor in a tv series', 'actor in a tv series', 'supporting actress in a motion picture', 'supporting actress in a motion picture', 'motion picture   drama', 'motion picture   drama', 'actress in a comedy', 'actress in a comedy', 'picture is cats', 'picture is cats', 'actress in a tv series drama   ', 'actress in a tv series drama   ', 'actress tv drama', 'actress tv drama', 'miniseries or tv movie', 'picture drama all films', 'picture drama all films', 'original song in a motion picture', 'original song in a motion picture', 'motion picture   drama kind', 'motion picture   drama kind', 'miniseries or tv movie', 'miniseries or tv movie', 'drama definitely a lot', 'drama definitely a lot', 'actress in a comedy or musical', 'actress in a comedy or musical', 'actress in a comedy or musical', 'actress in a comedy or musical', 'actor in a comedymusical', 'actor in a comedymusical', 'picture comedymusical fuck', 'picture comedymusical fuck', '  comedymusical actor', '  comedymusical actor', 'tv series comedy or musical', 'tv series comedy or musical', 'actress in a motion picture drama  ', 'actress in a motion picture drama  ', 'actress in a comedymusical', 'actress in a comedymusical', 'actress in a miniseries or tv movie', 'actress in a miniseries or tv movie', 'song love to a class act w a voice from another world', 'song love to a class act w a voice from another world', 'tv drama actress', 'tv drama actress', 'tv series drama', 'tv series drama', 'actress motion picture comedy or musical', 'actress motion picture comedy or musical', 'actress in a motion picture drama', 'actress in a motion picture drama', 'supporting actress in a motion picture', 'supporting actress in a motion picture', 'actress in a comedy or musical movie', 'actress in a comedy or musical movie', 'actress in a musical or comedy', 'actress in a musical or comedy', 'actress in a musical or comedy', 'original song in a motion picture', 'original song in a motion picture', 'director   motion picture', 'director   motion picture', 'actress motion picture   comedy or musical', 'actress motion picture   comedy or musical', 'actress motion picture   comedy or musical', 'actress in a comedy tv series   comedy or musical', 'actress in a comedy tv series   comedy or musical', 'actress in a comedy tv series   comedy or musical', 'motion picture drama', 'motion picture drama', 'original song while', 'original song while', 'picture musicalcomedy  ', 'picture musicalcomedy  ', 'actress in a comedy or musical', 'actress in a comedy or musical', 'picture musical or comedy', 'picture musical or comedy', 'performance in a motion picture', 'performance in a motion picture', 'motion picture comedy or musical   goldenglobes', 'actor in a tv drama', 'actor in a tv drama', 'original song in a motion picture', 'original song in a motion picture', 'original song in a motion picture', 'original song in a motion picture', 'actress in a motion picture   drama', 'actress in a motion picture   drama', 'actress in a motion picture   drama', 'tv series drama', 'tv series drama', 'musical   picture', 'tv mini seriesdrama', 'tv mini seriesdrama', 'picture drama although', 'picture drama although', 'original song while', 'original song while', 'actor in a comedymusical', 'actor in a comedymusical', 'miniseries or tv movie', 'miniseries or tv movie', 'actress   tv series   drama', 'actress   tv series   drama', 'performance in tv series   drama', 'performance in tv series   drama', 'recovery from a', 'recovery from a', 'actor in a miniseries or motion picture made for television', 'actor in a miniseries or motion picture made for television', 'actress in a musical or comedy', 'actress in a musical or comedy', 'actress in a musical or comedy', 'actress tv drama', 'actor comedy or musical', 'actor comedy or musical', 'comedy or musicial  ', 'tv comedy actress', 'tv comedy actress', 'actress in a tv series drama', 'actress in a tv series drama', 'actress in a drama television series', 'actress in a drama television series', 'actress in a television series love', 'actress in a television series love', 'actress in a comedy or musical movie', 'actress in a comedy or musical movie', 'tv series musical or comedy', 'tv series musical or comedy', 'tv drama series', 'actress in a drama', 'actress in a drama', 'actress in a tv movie', 'actress in a tv movie', 'motion picture   musical or comedy', 'motion picture   musical or comedy', 'motion picture drama', 'motion picture drama', 'actor in a motion picture drama', 'actor in a motion picture drama', 'actor tv series', 'actor tv series', 'picture due to a typo', 'picture due to a typo', 'actress in tv drama', 'actress in tv drama', 'picture   comedy or musical', 'picture   comedy or musical', 'actor in a drama', 'actor in a drama', 'motion picture drama yeah baby   go', 'picture   drama', 'picture   drama', 'picture   drama', 'picture   drama', 'actor tv series drama', 'actor tv series drama', 'drama tv actress', 'drama tv actress', 'actress in a tv series   comedy or musical', 'actress in a tv series   comedy or musical', 'mini series or tv movie', 'mini series or tv movie', 'tv series actress comedy or musical', 'tv series actress comedy or musical', 'picture drama wheeeeeeeeeeeeee', 'picture drama wheeeeeeeeeeeeee', 'motion picture   comedy or musical', 'picture   drama', 'picture   drama', 'tv series   drama', 'tv series   drama', 'tv series   drama', 'motion picture   drama', 'actress in a tv series   comedy or musical', 'actress in a tv series   comedy or musical', 'supporting actor in a series', 'supporting actor in a series', 'actress in a drama', 'actress in a drama', 'actor in tv series drama', 'actor in tv series drama', 'screenplay   finally', 'screenplay   finally', 'television series drama', 'television series drama', 'motion picture   drama', 'motion picture   drama', 'actress in a drama', 'actress in a drama', 'actress in a comedy or musical movie', 'actress in a comedy or musical movie', 'actor big win', 'actor big win', 'motion picture musical or comedy', 'motion picture musical or comedy', 'motion picture musical or comedy', 'supporting actress in a motion picture', 'supporting actress in a motion picture', 'actor mini series   tv movie', 'actor mini series   tv movie', 'actor mini series   tv movie', 'actor in a comedy', 'actor in a comedy', 'motion picture comedy or musical   goldenglobes', 'motion picture comedy or musical   goldenglobes', 'motion picture comedy or musical   goldenglobes', 'picture comedymusical do', 'picture comedymusical do', 'picture comedymusical do', 'actress in a tv series comedy or musical', 'actress in a tv series comedy or musical', 'comedymusical movie  ', 'comedymusical movie  ', 'drama huge upset', 'drama huge upset', 'actress in a dramatic film', 'foreign film still', 'foreign film still', 'actress tv   drama', 'actress tv   drama', 'actor in a drama series', 'actor in a drama series', 'motion picture drama', 'comedy or musical', 'comedy or musical', 'picture comedy or musical good call afp good call', 'picture comedy or musical good call afp good call', 'actor in a musicalcomedy', 'actor in a musicalcomedy', 'actress in a tv series comedymusical thanks to girls   hopefully', 'actress in a tv series comedymusical thanks to girls   hopefully', 'tv series   comedy or musical', 'actor in a motion picture comedy or musical', 'actor in a motion picture comedy or musical', 'actress motion picture comedy or musical', 'actress motion picture comedy or musical', 'actor in a motion picture drama', 'actor in a motion picture drama', 'actress in a supporting role in a motion picture', 'actress in a supporting role in a motion picture', 'motion picture comedy or musical', 'motion picture comedy or musical', 'motion picture comedy or musical', 'actress in a musical or comedy', 'actress in a musical or comedy', 'actress in a musical or comedy', 'performance by an actress in a tv series', 'performance by an actress in a tv series', 'actress in a comedy series    yay', 'actress in a comedy series    yay', 'actor tv series or drama', 'actor tv series or drama', 'actress in miniseries', 'actress in miniseries', 'actress in a comedy series', 'actress in a comedy series', 'motion picture old', 'motion picture old', 'supporting actress in a motion picture', 'supporting actress in a motion picture', 'actress in a   drama', 'actor in a motion picture   drama', 'actor in a motion picture   drama', 'tv series   drama', 'tv series   drama', 'tv series   drama', 'tv mini seriesdrama', 'tv mini seriesdrama', 'actress in a miniseries', 'actress in a miniseries', 'motion picture comedy or musical  ', 'motion picture comedy or musical  ', 'motion picture musical or comedy', 'motion picture musical or comedy', 'tv drama actress', 'tv drama actress', 'actress in a television series drama', 'actress in a television series drama', 'actress in a comedy or musical movie', 'actress in a comedy or musical movie', 'tv series comedy or musical', 'tv series comedy or musical', 'actress in tv drama', 'actress in tv drama', 'actor in a drama tv', 'actor in a drama tv', 'actor in a tv drama', 'actor in a tv drama', 'actress in a tv miniseries or motion picture made', 'actress in a tv miniseries or motion picture made', 'television series comedy or misical', 'television series comedy or misical', 'motion picture   comedy or musical', 'motion picture   comedy or musical', 'actress in a comedy', 'actress in a comedy', 'actress in a comedy', 'actress in a comedy', 'actress in a motion picture   comedy', 'actress in a motion picture   comedy', 'actess in a tv series drama  ', 'actess in a tv series drama  ', 'tv musical or comedy', 'tv musical or comedy', 'motion picture musical or comedy', 'motion picture musical or comedy', 'motion picture screenplay', 'motion picture screenplay', 'actress in a comedymusical', 'actress in a comedymusical', 'actress movie drama', 'actress movie drama', 'actress in a motion picture', 'actress in a motion picture', 'actress in a motion picture   drama', 'actress in a motion picture   drama', 'actor motion picture', 'actor motion picture', 'actress in a supporting role in a motion picture', 'actress in a supporting role in a motion picture', 'motion picture comedy or musical', 'motion picture comedy or musical', 'motion picture comedy or musical', 'actress in a motion picture drama', 'actress in a motion picture drama', 'actress in a tv series drama', 'actress in a tv series drama', 'performance by an actress in a tv musical or comedy', 'performance by an actress in a tv musical or comedy', 'actress in drama', 'actress in drama', 'actress in comedymusical', 'actress in comedymusical', 'actress motion picture comedy or musical', 'actress motion picture comedy or musical', 'actress in a tv series comedy series', 'actress in a tv series comedy series', 'motion picture screenplay', 'motion picture screenplay', 'actor in a television series comedy or musical 4', 'actor in a television series comedy or musical 4', 'actor in a television series comedy or musical 4', 'actor in a motion picture musical or comedy', 'actor in a motion picture musical or comedy', 'actor in a tv movie', 'actor in a tv movie', 'original score sure', 'original score sure', 'actress in a motion picture drama  ', 'actress in a motion picture drama  ', 'actor in a tv series   comedy', 'actor in a tv series   comedy', 'actor in a tv series   comedy', 'actress in a tv drama', 'actress in a tv drama', 'motion picture   comedy or musical', 'motion picture   comedy or musical', 'actress motion picture comedy or musical', 'actress motion picture comedy or musical', 'actress in a musicalcomedy', 'actress in a musicalcomedy', 'actor comedy or', 'actor comedy or', 'actress comedymusical first win', 'lead actor in a drama', 'lead actor in a drama', 'actor in miniseries', 'actor in miniseries', 'actor movie comedy or musical singtalk to', 'actor movie comedy or musical singtalk to', 'motion picture comedy or musical great', 'motion picture comedy or musical great', 'foreign language film', 'foreign language film', 'original song awesome song', 'original song awesome song', 'motion picture comedy or musical', 'motion picture comedy or musical', 'actor in a drama', 'actor in a drama', 'motion picture great movie', 'motion picture great movie', 'actress tv series  ', 'actress in a drama', 'actress in a drama', 'actress in a drama', 'actor in a motion picture drama', 'actor in a motion picture drama', 'actress in tv', 'actress in tv', 'actress in tv', 'picture   comedy or musical', 'picture   comedy or musical', 'actress in a tv series drama', 'actress in a tv series drama', 'comedy tv series more', 'comedy tv series more', 'actress in a tv series   drama', 'actress in a tv series   drama', 'picture by foreign press speech', 'tv actress in a comedy from girls', 'actress in a comedy or musical hmm', 'actress in a comedy or musical hmm', 'motion picture drama great movie nonetheless', 'motion picture drama great movie nonetheless', 'actor in a drama', 'actor in a drama', 'actress in a drama hands down', 'actress in a drama hands down', 'actress in a comedy or musical movie', 'actress in a comedy or musical movie', 'actor in a miniseries or motion picture made for television', 'actor in a miniseries or motion picture made for television', 'actor in a motion picture in', 'actor in a motion picture in', 'actor in a musical or comedy award', 'actor in a musical or comedy award', 'actress in a dramatic film', 'actress in a dramatic film', 'actor tv series or drama', 'actor tv series or drama', 'actor tv series or drama', 'actor in a television series comedy or musical', 'actor in a television series comedy or musical', 'miniseries or motion picture made for television', 'miniseries or motion picture made for television', 'motion picture   comedy or musical', 'motion picture   comedy or musical', 'director   motion picture', 'director   motion picture', 'actor in drama as world collectively', 'actor in drama as world collectively', 'tv drama much much', 'tv drama much much', 'actress in a comedy', 'actress in a comedy', 'picture musical or comedy', 'picture musical or comedy', 'actress in a tv miniseries or movie', 'actress in a tv miniseries or movie', 'actress in a tv miniseries or movie', 'motion picture comedy or musical massive', 'motion picture comedy or musical massive', 'comedy or musical tv series', 'comedy or musical tv series', 'picture   comedy or musical', 'motion picture comedy or musical', 'motion picture comedy or musical', 'performance by an actress in a television series   drama', 'performance by an actress in a television series   drama', 'foreign film  ', 'foreign film  ', 'actress in miniseriestv movie', 'actress in miniseriestv movie', 'bond song ever', 'bond song ever', 'original song while', 'original song while', 'supporting actor   really', 'supporting actor   really', 'motion picture in drama category', 'motion picture in drama category', 'original song in a motion picture', 'picture   drama', 'picture   drama', '  actress in a musical or comedy', 'actress in a dramatic film', 'actress in a dramatic film', 'actor in a motion picture drama', 'actor in a motion picture drama', 'actor in a tv show', 'actor in a tv show', 'song unsurprisingly seriously', 'song unsurprisingly seriously', 'actor in a motion picture comedy or musical', 'actor in a motion picture comedy or musical', 'tv series   comedy or musical', 'tv series   comedy or musical', 'picture   comedy or musical', 'picture   comedy or musical', 'screenplay   motion picture', 'screenplay   motion picture', 'comedy or musical tv series', 'comedy or musical tv series', 'motion picture well', 'motion picture well', 'motion picture comedy or musical', 'motion picture comedy or musical', 'actress in a comedy', 'actress in a comedy', 'screenplay   very well', 'screenplay   very well', 'motion picture comedy or musical', 'motion picture comedy or musical', 'picture   drama', 'picture   drama', 'tv series drama', 'supporting actress in a motion picture', 'supporting actress in a motion picture', 'actress in a motion picture drama', 'actress in a motion picture drama', 'director   motion picture', 'director   motion picture', 'director   motion picture', 'motion picture   drama', 'motion picture   drama', 'picture musical or comedy', 'picture musical or comedy', 'actress in tv drama', 'actress in tv drama', 'actor motion picture   drama', 'actor motion picture   drama', 'drama motion picture', 'motion picture drama  ', 'motion picture drama  ', 'motion picture comedy or musical', 'motion picture comedy or musical', 'director   motion picture', 'actor in a tv drama', 'actor in a tv drama', 'screenplay motion picture', 'motion picture drama', 'motion picture drama', 'actress in a miniseries or tv movie', 'actress in a miniseries or tv movie', 'motion picture comedy or musical', 'actor in a tv drama series', 'actor in a tv drama series', 'actor in comedy or musical', 'actor in comedy or musical', 'actress in tv movie', 'actress in tv movie', 'actress in a comedy series', 'actress in a comedy series', 'actor in a comedy or musical tv series', 'actor in a comedy or musical tv series', 'actor in a television series comedy or musical', 'actor in a television series comedy or musical', 'actor motion picture   drama', 'actor motion picture   drama', 'actor in a comedy or musical', 'actor in a comedy or musical', 'motion picture drama', 'motion picture drama', 'picture   comedy or musical', 'picture   comedy or musical', 'tv series drama', 'tv series drama', 'foreign language film', 'foreign language film', 'motion picture in comedy or musical category', 'motion picture in comedy or musical category', 'actor in a motion picture drama', 'television series drama', 'television series drama', 'motion picture   comedy or musical', 'motion picture   comedy or musical', 'picture   drama', 'picture comedy or musical', 'picture comedy or musical', 'foreign language film', 'foreign language film', 'director   motion picture', 'director   motion picture', 'picture   comedy or musical   ', 'actress in a motion picture drama', 'actress in a motion picture drama', 'actor in a motion picture comedy or musical', 'actor in a motion picture comedy or musical', 'motion picture drama', 'motion picture drama', 'picture   drama', 'picture   drama', 'picture   drama', 'picture   drama', 'motion picture drama   congratulations', 'motion picture drama   congratulations', 'foreign language film', 'foreign language film', 'foreign language film', 'foreign language film', 'actress in a motion picture drama', 'actress in a motion picture drama', 'miniseries or tv movie category', 'miniseries or tv movie category', 'actress in a mini series or tv movie', 'actress in a mini series or tv movie', 'actor in a motion picture   drama', 'actor in a motion picture   drama', 'actor in a motion picture   drama', 'actress in a musicalcomedy', 'actress in a musicalcomedy', 'performance by an actor in a motion picture   drama', 'performance by an actor in a motion picture   drama', 'actress motion picture   comedy or musical', 'actress motion picture   comedy or musical', 'actor in a tv comedymusical', 'actor in a tv comedymusical', 'actress in motion', 'actress in motion', 'supporting actress  ', 'supporting actress  ', 'comedy   musical', 'comedy   musical', 'supporting actress in a motion picture', 'supporting actress in a motion picture', 'actress motion picture', 'actress motion picture', 'actress in a tv series drama', 'actress in a tv series drama', 'motion picture comedy or musical', 'motion picture comedy or musical', 'actress in a motion picture   drama', 'actress in a motion picture   drama', 'motion picture screenplay', 'motion picture screenplay', 'motion picture screenplay', 'motion picture   drama', 'motion picture   drama', 'actress in miniseriestv movie', 'actress in miniseriestv movie', 'actress in a supporting role in a motion picture', 'actress in a supporting role in a motion picture', 'performance by an actress in a tv musical or comedy', 'performance by an actress in a tv musical or comedy', 'performance by an actress in a tv series', 'performance by an actress in a tv series', 'picture drama   ', 'picture drama   ', 'actor in a motion picture comedy or musical', 'actor in a motion picture comedy or musical', 'motion picture drama', 'motion picture drama', 'tv drama really', 'tv drama really', 'tv drama really', 'original song motion picture', 'actress in a comedy', 'actress in a comedy', 'motion picture drama', 'actor in a motion picture   drama', 'actor in a motion picture   drama', 'actor in a motion picture   drama', 'tv comedy series', 'tv comedy series', 'motion picture drama', 'motion picture drama', 'foreign language film', 'foreign language film', 'foreign language film', 'supporting actress in a motion picture', 'supporting actress in a motion picture', 'picture musical or comedy', 'picture musical or comedy', 'tv movie et', 'tv movie et', 'foreign language film', 'foreign language film', '  actress in a musical or comedy', '  actress in a musical or comedy', 'actress in a comedy or musical', 'actress in a comedy or musical', 'actor in tv series', 'miniseries or tv movie', 'miniseries or tv movie', 'actress in a drama', 'actress in a drama', 'actress in a drama', 'actress in a drama', 'score poor cloud', 'score poor cloud', 'score poor cloud', 'motion picture drama', 'motion picture drama', 'motion picture comedy or musical', 'motion picture comedy or musical', 'motion picture drama', 'motion picture drama', 'actor drama 8', 'actor drama 8', 'miniseries or tv movie', 'miniseries or tv movie', 'actress in a drama series', 'actress in a drama series', 'motion picture comedy or musical', 'motion picture comedy or musical', 'actor in a miniseriestv movie', 'actor in a miniseriestv movie', 'comedy series in a', 'comedy series in a', 'supporting actor have nt', 'supporting actor have nt', 'motion picture comedy or musical', 'motion picture comedy or musical', 'actor comedy or musical', 'actor comedy or musical', 'picture musical or comedy', 'picture musical or comedy', 'actor in a drama', 'actor in a drama', 'miniseries or tv movie', 'miniseries or tv movie', 'actor in a tv series   drama', 'original song in a motion picture', 'original song in a motion picture', 'supporting actress xd', 'actor tv comedy award', 'actor tv comedy award', 'actor in a drama hands down', 'actor in a drama hands down', 'picture   great', 'picture   great', 'actress in a musical or comedy', 'actress in a musical or comedy', 'actress in a musical or comedy', 'actress in a motion picture   drama', 'actress in a motion picture   drama', 'actor in a miniseriestv movie', 'original song motion picture', 'original song motion picture', 'actress in a miniseries or tv movie', 'actress in a miniseries or tv movie', 'motion picture comedy or musical', 'motion picture comedy or musical', 'actor in a drama', 'actor in a drama', 'motion picture drama', 'motion picture drama', 'actor in a tv miniseriesmovie', 'actor in a tv miniseriesmovie', 'actor in a motion picture drama', 'actor in a motion picture drama', 'actor motion picture drama', 'actor motion picture drama', 'tv series   comedy or musical', 'actor   drama   award', 'actor   drama   award', 'suppporting actor  ', 'suppporting actor  ', 'lead actor in a drama', 'lead actor in a drama', 'actor in musical or', 'actor in musical or', 'tv series drama', 'tv series drama', 'actress in miniseries or tv movie', 'actress in miniseries or tv movie', 'original song  ', 'original song  ', 'actress in a drama', 'actress in a drama', 'actor in a comedy or musical tv series', 'actor in a comedy or musical tv series', 'actor in a musical or comedy award', 'actor in a musical or comedy award', 'actor in a television series comedy or musical', 'actor in a television series comedy or musical', 'actor in a musical or comedy award', 'actor in a musical or comedy award', 'actor in a miniseries or motion picture made for television', 'actor in a miniseries or motion picture made for television', 'picture   drama', 'picture   drama', 'picture   drama', 'picture   drama', 'actress in a comedy', 'actress in a comedy', 'actor in a miniseries or motion picture made for television', 'actor in a miniseries or motion picture made for television', 'actor in a drama', 'actor in a drama', 'drama tv series', 'drama tv series', 'dramatic picture oh please', 'dramatic picture oh please', 'actor tv movie or mini', 'actor tv movie or mini', 'actress in comedy or musical in film', 'actress in comedy or musical in film', 'actor in a musical or comedy', 'actor in a musical or comedy', 'picture musical or comedy', 'picture musical or comedy', 'motion picture totally', 'motion picture totally', 'comedy or musical tv series', 'actor in motion picture comedy or musical', 'actor in motion picture comedy or musical', 'old man crush  ', 'old man crush  ', 'actor in a comedy or musical tv series', 'actor in a comedy or musical tv series', 'performance by an actress in', 'performance by an actress in a tv series   musical or comedy', 'performance by an actress in a tv series   musical or comedy', 'motion picture musical or comedy   yesssssss', 'motion picture musical or comedy   yesssssss', 'motion picture musical or comedy   yesssssss', 'actress in musical or comedy', 'actress in musical or comedy', 'actress in a dramatic film', 'actress in a dramatic film', 'motion picture musical or comedy', 'motion picture   comedy or musical', 'motion picture   comedy or musical', 'actor in a tv comedymusical', 'actor in a tv comedymusical', 'screenplay   motion picture', 'picture   comedy or musical', 'motion picture drama', 'motion picture drama', 'motion picture screenplay', 'motion picture screenplay', 'actor in a drama', 'actor in a drama', 'actress in miniseriestv movie', 'actress in miniseriestv movie', 'actor in a drama', 'actor in a drama', 'tv drama series', 'tv drama series', 'original song in a motion picture', 'television show musicalcomedy', 'television show musicalcomedy', 'television series drama yes', 'television series drama yes', 'tv movie  ', 'tv movie  ', 'supporting actress in a motion picture', 'supporting actress in a motion picture', 'motion picture drama', 'motion picture drama', 'actressmotion picturecomedy or musical', 'actressmotion picturecomedy or musical', 'actress in a motion picture   comedy', 'actress in a motion picture   comedy', 'comedy or musical', 'comedy or musical', 'actor   comedy or musical', 'actor   comedy or musical', 'song unsurprisingly seriously', 'song unsurprisingly seriously', 'actor in a comedy or musical', 'actor in a comedy or musical', 'movie comedy or musical', 'movie comedy or musical', 'actor in a motion picture in', 'actor in a motion picture in', 'tv movieminiseries definitely', 'tv movieminiseries definitely', 'actor in a miniseries', 'actor in a miniseries', 'actor in a miniseries', 'actor in a comedy or musical tv series', 'actor in a comedy or musical tv series', 'actor   drama', 'actor   drama', 'actress in a tv series drama   ', 'actress in a tv series drama   ']

    """ Initial reduction of tweets - converge actors and actresses"""
    tweet_dataframe = pd.DataFrame(tweets, columns=['strings'])
    tweet_dataframe['strings'] = tweet_dataframe['strings'].str.strip()


    def replace(x):
        x = " ".join(x.split())
        if 'actress' in x:
            x = x.replace('actress', 'actor')
        return x 

    tweet_dataframe['strings'] = tweet_dataframe['strings'].apply(replace)
    # print(tweet_dataframe)


    phrase_counts = tweet_dataframe['strings'].value_counts()
    df_unique_sorted = phrase_counts.reset_index()
    df_unique_sorted.columns = ['phrase', 'count']
    df_unique_sorted = df_unique_sorted[df_unique_sorted['count'] > 2]
    condensed_list_of_awards = df_unique_sorted['phrase'].to_list() 


    def actor(tweets):
        result = []
        for phrase in tweets:
            threshold = 67
            if all(fuzz.ratio(phrase, existing) < threshold for existing in result):
                    result.append(phrase)
        results2 = []
        for award in result:
            if "performance" not in award:
                award1 = ("best performance by an " + award)
                duplicated_award = ("best performance by an " + award.replace('actor', 'actress'))
                results2.append(duplicated_award)
                results2.append(award1)
            else:
                award1 = ("best by an " + award)
                duplicated_award = ("best " + award.replace('actor', 'actress'))
                results2.append(duplicated_award)
                results2.append(award1)
        return results2

    def movie(tweets):
        result = []
        for phrase in tweets:
            threshold = 67
            if all(fuzz.ratio(phrase, existing) < threshold for existing in result):
                    result.append(phrase)

        filtered_phrases = [phrase for phrase in result if "picture" not in phrase or re.search(r'\bmotion picture\b', phrase)]
        result_2 = []
        for award in filtered_phrases:
            award = ("best " + award)
            result_2.append(award)
        return result_2



    def tv(tweets):
        result = []
        for phrase in tweets:
            threshold = 50
            if all(fuzz.ratio(phrase, existing) < threshold for existing in result):
                result.append(phrase)
        result_2 = []
        for award in result:
            award = ("best " + award)
            result_2.append(award)

        return result_2

        # matched_tweets = []
        # for phrase2 in result:
        #     for tweet in condensed_list_of_awards:
        #         # Calculate similarity between phrase and tweet
        #         similarity = fuzz.ratio(phrase2, tweet)
        #         if similarity >= threshold:
        #             # Store similar tweets with the phrase they matched
        #             matched_tweets.append((phrase2, tweet, similarity))
        finallly = [("best " + award) for award in result]



    actor_list = []
    tv_show_list = []
    movie_list = [] 
    for tweet in condensed_list_of_awards:
        if "actor" in tweet or "supporting" in tweet:
            actor_list.append(tweet)
        elif 'tv' in tweet or 'television' in tweet:
            tv_show_list.append(tweet)
        else:
            movie_list.append(tweet)
    awards_list = [actor(actor_list), movie(movie_list), tv(tv_show_list)]

    return awards_list 


    call_actors = actor(actor_list)
    call_movies = movie(movie_list)
    call_tweets = tv(tv_show_list)
